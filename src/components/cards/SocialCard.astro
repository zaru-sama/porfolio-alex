---
import social from "@/collections/social.json";
const { displaySocialIds } = Astro.props;

const filteredSocial = social.filter((item) => {
  if (item.isShow === false) return false;
  if (displaySocialIds.length > 0) {
    return displaySocialIds.includes(item.id);
  }
  return true;
});
---

<div class="social-cards-wrapper">
  <div class="social-list">
    {
      filteredSocial.map((item, index) => (
        <a
          href={item.url}
          target="_blank"
          rel="noopener noreferrer"
          class="social-item"
          style={`--index: ${index}; --total: ${filteredSocial.length};`}
        >
          <img src={item.image} alt={item.name} class="social-image" />
          <div class="social-info">
            <div class="social-username">@{item.username}</div>
          </div>
        </a>
      ))
    }
  </div>
</div>

<style>
  .social-cards-wrapper {
    position: relative;
    width: 100%;
  }

  .social-list {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    height: 100px;
    max-width: 450px;
  }

  @media (max-width: 768px) {
    .social-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      height: auto;
      justify-content: center;
    }
  }

  .social-item {
    position: relative;
    overflow: hidden;
    border-radius: 0.75rem;
    cursor: pointer;

    transition:
      transform 0.6s cubic-bezier(0.34, 1.2, 0.64, 1),
      z-index 0s linear 0.6s,
      box-shadow 0.3s ease;
    transition-delay: calc(var(--index) * 0.03s);
    width: 100px;
    height: 100px;
  }

  @media (min-width: 769px) {
    .social-item {
      position: absolute;
      left: 0;

      transform: translateX(calc(var(--index) * 8px))
        rotate(calc(var(--index) * 8deg));

      z-index: calc(var(--total) - var(--index));
    }
  }

  @media (max-width: 768px) {
    .social-item {
      position: relative;
      transform: none;
      transition-delay: 0s;
      width: 80px;
      height: 80px;
    }
  }

  @media (min-width: 769px) {
    .social-list:hover .social-item {
      transform: translateX(calc(var(--index) * 110px)) rotate(0deg);

      z-index: calc(var(--index) + 100);

      transition:
        transform 0.6s cubic-bezier(0.34, 1.2, 0.64, 1),
        z-index 0s linear 0s,
        box-shadow 0.3s ease;
      transition-delay: calc(var(--index) * 0.03s);
    }

    .social-list:hover .social-item:hover {
      transform: translateX(calc(var(--index) * 80px)) translateY(-10px)
        rotate(-6deg) scale(1.05);
      z-index: 9999;

      transition:
        transform 0.35s cubic-bezier(0.34, 1.5, 0.64, 1),
        z-index 0s linear 0s,
        box-shadow 0.3s ease;
    }
  }

  .social-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0.75rem; /* rounded-xl */
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .social-item:hover .social-image {
    transform: scale(1.15);
  }

  .social-info {
    position: absolute;
    bottom: 6px;
    left: 6px;
    z-index: 10;
    transition: opacity 0.3s;
  }

  .social-username {
    font-size: 8px;
    color: rgba(255, 255, 255, 0.85);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .social-item:hover {
    box-shadow:
      0 15px 32px rgba(0, 0, 0, 0.15),
      0 5px 12px rgba(0, 0, 0, 0.1);
  }

  @media (max-width: 768px) {
    .social-item:active {
      transform: scale(0.95);
    }
  }
</style>
